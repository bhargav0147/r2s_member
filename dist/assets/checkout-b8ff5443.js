import{bE as ee,bC as E,bF as te,bG as B,bH as se,aa as T,bI as re,bJ as ne,bK as oe,bL as ae,j as e,S as p,bM as q,T as x,as as f,aT as ie,l as a,c as W,d as g,ai as ce,e as $,ad as I,bN as le,F as L,bO as de,bP as ue,bQ as pe,f as S,ak as he,bR as F,r as xe,h as y,bS as me,aI as C,i as H,o as z,ar as k,at as _,b2 as w,ah as ye,b1 as be,bt as D,al as je,b as N,bs as fe,aG as v,aP as Ce,aQ as R,b0 as ve,bT as ge,g as Se,aW as we,aX as Te,aY as Re,aZ as Oe,a_ as Ie,br as ke,R as _e,bU as De,af as Ae,bV as Pe,aR as Ee,b9 as Me,bW as Fe,bX as Be,av as qe,aA as We,aD as $e,bY as Le,bZ as He,W as ze}from"./index-6b9b4714.js";import"./search-not-found-72e0441b.js";import{C as Ne}from"./CardContent-9cce7f0e.js";import{P as Ge}from"./payment-new-card-dialog-2f959f68.js";import{S as Qe,a as Ue,b as Ve,s as Ke,M as Ye,c as O}from"./Stepper-08725d8b.js";var Ze=function(t){ee(o,t);function o(i,r){var s;return s=t.call(this)||this,s.client=i,s.setOptions(r),s.bindMethods(),s.updateResult(),s}var c=o.prototype;return c.bindMethods=function(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)},c.setOptions=function(r){this.options=this.client.defaultMutationOptions(r)},c.onUnsubscribe=function(){if(!this.listeners.length){var r;(r=this.currentMutation)==null||r.removeObserver(this)}},c.onMutationUpdate=function(r){this.updateResult();var s={listeners:!0};r.type==="success"?s.onSuccess=!0:r.type==="error"&&(s.onError=!0),this.notify(s)},c.getCurrentResult=function(){return this.currentResult},c.reset=function(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})},c.mutate=function(r,s){return this.mutateOptions=s,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,E({},this.options,{variables:typeof r<"u"?r:this.options.variables})),this.currentMutation.addObserver(this),this.currentMutation.execute()},c.updateResult=function(){var r=this.currentMutation?this.currentMutation.state:te(),s=E({},r,{isLoading:r.status==="loading",isSuccess:r.status==="success",isError:r.status==="error",isIdle:r.status==="idle",mutate:this.mutate,reset:this.reset});this.currentResult=s},c.notify=function(r){var s=this;B.batch(function(){s.mutateOptions&&(r.onSuccess?(s.mutateOptions.onSuccess==null||s.mutateOptions.onSuccess(s.currentResult.data,s.currentResult.variables,s.currentResult.context),s.mutateOptions.onSettled==null||s.mutateOptions.onSettled(s.currentResult.data,null,s.currentResult.variables,s.currentResult.context)):r.onError&&(s.mutateOptions.onError==null||s.mutateOptions.onError(s.currentResult.error,s.currentResult.variables,s.currentResult.context),s.mutateOptions.onSettled==null||s.mutateOptions.onSettled(void 0,s.currentResult.error,s.currentResult.variables,s.currentResult.context))),r.listeners&&s.listeners.forEach(function(l){l(s.currentResult)})})},o}(se);function Je(t,o,c){var i=T.useRef(!1),r=T.useState(0),s=r[1],l=re(t,o,c),u=ne(),d=T.useRef();d.current?d.current.setOptions(l):d.current=new Ze(u,l);var n=d.current.getCurrentResult();T.useEffect(function(){i.current=!0;var m=d.current.subscribe(B.batchCalls(function(){i.current&&s(function(b){return b+1})}));return function(){i.current=!1,m()}},[]);var h=T.useCallback(function(m,b){d.current.mutate(m,b).catch(oe)},[]);if(n.error&&ae(void 0,d.current.options.useErrorBoundary,[n.error]))throw n.error;return E({},n,{mutate:h,mutateAsync:n.mutate})}function G({address:t,action:o,sx:c,...i}){const{order_reciver_name:r,address_line_1:s,type:l,order_reciver_mobile_number:u,primary:d}=t;return e.jsxs(p,{component:q,spacing:2,alignItems:{md:"flex-end"},direction:{xs:"column",md:"row"},sx:{position:"relative",...c},...i,children:[e.jsxs(p,{flexGrow:1,spacing:1,children:[e.jsxs(p,{direction:"row",alignItems:"center",children:[e.jsxs(x,{variant:"subtitle2",children:[r,e.jsxs(f,{component:"span",sx:{ml:.5,typography:"body2",color:"text.secondary"},children:["(",l==="home_delivery"?"Home":"Office",")"]})]}),d&&e.jsx(ie,{color:"info",sx:{ml:1},children:"Default"})]}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:s}),e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:u})]}),o&&o]})}G.propTypes={action:a.node,address:a.object,sx:a.object};function Q({open:t,onClose:o,refetch:c}){const i=W().shape({name:g().required("Fullname is required"),phone:g().required("Phone number is required"),address_line_1:g().required("Address is required"),city:g().required("City is required"),state:g().required("State is required"),country:g().required("Country is required"),pincode:g().required("Zip code is required"),type:g(),primary:ce()}),r={name:"",city:"",state:"",address_line_1:"",pincode:"",phone:"",type:"HOME",country:""},s=$({resolver:z(i),defaultValues:r}),{handleSubmit:l,formState:{isSubmitting:u}}=s,d=l(async n=>{try{const h=await I.post("/api/member/ecommerce/address/add",n);console.log(h.data),c(),o()}catch(h){console.error(h)}});return e.jsx(le,{fullWidth:!0,maxWidth:"sm",open:t,onClose:o,children:e.jsxs(L,{methods:s,onSubmit:d,children:[e.jsx(de,{children:"New address"}),e.jsx(ue,{dividers:!0,children:e.jsxs(p,{spacing:3,children:[e.jsx(pe,{row:!0,name:"type",options:[{label:"Home",value:"HOME"},{label:"Office",value:"OFFICE"}]}),e.jsxs(f,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(2, 1fr)"},children:[e.jsx(S,{name:"name",label:"Full Name"}),e.jsx(S,{name:"phone",label:"Phone Number"})]}),e.jsx(S,{name:"address_line_1",label:"Address"}),e.jsxs(f,{rowGap:3,columnGap:2,display:"grid",gridTemplateColumns:{xs:"repeat(1, 1fr)",sm:"repeat(3, 1fr)"},children:[e.jsx(S,{name:"city",label:"Town / City"}),e.jsx(S,{name:"state",label:"State"}),e.jsx(S,{name:"pincode",label:"Zip/Code"})]}),e.jsx(he,{name:"country",label:"Country",options:F.map(n=>n.label),getOptionLabel:n=>n,renderOption:(n,h)=>{const{code:m,label:b,phone:j}=F.filter(P=>P.label===h)[0];return b?xe.createElement("li",{...n,key:b},e.jsx(y,{icon:`circle-flags:${m.toLowerCase()}`,width:28,sx:{mr:1}},b),b," (",m,") +",j):null}})]})}),e.jsxs(me,{children:[e.jsx(C,{color:"inherit",variant:"outlined",onClick:o,children:"Cancel"}),e.jsx(H,{type:"submit",variant:"contained",loading:u,children:"Deliver to this Address"})]})]})})}Q.propTypes={onClose:a.func,onCreate:a.func,open:a.bool};a.node,a.array,a.func,a.func,a.bool,a.func,a.string;function A({total:t,discount:o,subTotal:c,shipping:i,onEdit:r,onApplyDiscount:s,checked:l,handleChange:u,shippingFee:d}){const n=d!==null?d:"Free";return e.jsxs(k,{sx:{mb:3},children:[e.jsx(_,{title:"Order Summary",action:r&&e.jsx(C,{size:"small",onClick:r,startIcon:e.jsx(y,{icon:"solar:pen-bold"}),children:"Edit"})}),e.jsx(Ne,{children:e.jsxs(p,{spacing:2,children:[e.jsxs(p,{direction:"row",justifyContent:"space-between",children:[e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Sub Total"}),e.jsx(x,{variant:"subtitle2",children:w(c)})]}),e.jsxs(p,{direction:"row",justifyContent:"space-between",children:[e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Discount"}),e.jsx(x,{variant:"subtitle2",children:o?w(-o):"-"})]}),e.jsxs(p,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Use WalletBalance"}),e.jsx(ye,{color:"success",sx:{marginRight:"-15px"},checked:l,onChange:u})]}),e.jsxs(p,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[e.jsx(x,{variant:"body2",sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(x,{variant:"subtitle2",children:d?w(d):n})]}),e.jsx(be,{sx:{borderStyle:"dashed"}}),e.jsxs(p,{direction:"row",justifyContent:"space-between",children:[e.jsx(x,{variant:"subtitle1",children:"Total"}),e.jsxs(f,{sx:{textAlign:"right"},children:[e.jsx(x,{variant:"subtitle1",sx:{color:"error.main"},children:w(t)}),e.jsx(x,{variant:"caption",sx:{fontStyle:"italic"},children:"(VAT included if applicable)"})]})]})]})})]})}A.propTypes={total:a.number,discount:a.number,shipping:a.number,subTotal:a.number,onEdit:a.func,onApplyDiscount:a.func,checked:a.bool,handleChange:a.func,shippingFee:a.number};function Xe(){const t=D(),{enqueueSnackbar:o}=je(),c=N(),i=async()=>{const{data:n}=await I.get("/api/member/ecommerce/address");return n==null?void 0:n.data},{data:r,isLoading:s,error:l,refetch:u}=fe("addresses",i,{staleTime:6e4,cacheTime:36e5}),d=Je(n=>I.delete(`/api/member/ecommerce/address/${n}`),{onSuccess:()=>{u(),o("Deleted Successfully")},onError:n=>{var h,m;console.log(n),o(((m=(h=n==null?void 0:n.response)==null?void 0:h.data)==null?void 0:m.message)||"Internal Server Error",{variant:"error"})}});return e.jsxs(e.Fragment,{children:[e.jsxs(v,{container:!0,spacing:3,children:[e.jsxs(v,{xs:12,md:8,children:[r==null?void 0:r.map(n=>{if(!(n!=null&&n.is_delete))return e.jsx(G,{address:n,action:e.jsxs(p,{flexDirection:"row",flexWrap:"wrap",flexShrink:0,children:[!n.primary&&e.jsx(C,{onClick:()=>d.mutate(n.id),size:"small",color:"error",sx:{mr:1},children:"Delete"}),e.jsx(C,{variant:"outlined",size:"small",onClick:()=>t.onCreateBilling(n),children:"Deliver to this Address"})]}),sx:{p:3,mb:3,borderRadius:2,boxShadow:h=>h.customShadows.card}},n.id)}),e.jsxs(p,{direction:"row",justifyContent:"space-between",children:[e.jsx(C,{size:"small",color:"inherit",onClick:t.onBackStep,startIcon:e.jsx(y,{icon:"eva:arrow-ios-back-fill"}),children:"Back"}),e.jsx(C,{size:"small",color:"primary",onClick:c.onTrue,startIcon:e.jsx(y,{icon:"mingcute:add-line"}),children:"New Address"})]})]}),e.jsx(v,{xs:12,md:4,children:e.jsx(A,{total:t.total,subTotal:t.subTotal,discount:t.discount,checked:t.checked,handleChange:t.handleCheckChange,shippingFee:t==null?void 0:t.shipping})})]}),e.jsx(Q,{refetch:u,open:c.value,onClose:c.onFalse,onCreate:t.onCreateBilling})]})}function U({row:t,onDelete:o,onDecrease:c,onIncrease:i}){const{name:r,size:s,price:l,colors:u,coverUrl:d,quantity:n,available:h,image:m}=t;return e.jsxs(Ce,{children:[e.jsxs(R,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(ve,{variant:"rounded",alt:r,src:m,sx:{width:64,height:64,mr:2}}),e.jsx(p,{spacing:.5,children:e.jsx(x,{noWrap:!0,variant:"subtitle2",sx:{maxWidth:240},children:r})})]}),e.jsx(R,{children:w(l)}),e.jsx(R,{children:e.jsx(f,{sx:{width:88,textAlign:"right"},children:e.jsx(ge,{quantity:n,onDecrease:c,onIncrease:i,disabledDecrease:n<=1,disabledIncrease:n>=h})})}),e.jsx(R,{align:"right",children:w(l*n)}),e.jsx(R,{align:"right",sx:{px:1},children:e.jsx(Se,{onClick:o,children:e.jsx(y,{icon:"solar:trash-bin-trash-bold"})})})]})}U.propTypes={row:a.object,onDelete:a.func,onDecrease:a.func,onIncrease:a.func};const et=[{id:"product",label:"Product"},{id:"price",label:"Price"},{id:"quantity",label:"Quantity"},{id:"totalAmount",label:"Total Price",align:"right"},{id:""}];function V({products:t,onDelete:o,onIncreaseQuantity:c,onDecreaseQuantity:i}){return e.jsx(we,{sx:{overflow:"unset"},children:e.jsx(Te,{children:e.jsxs(Re,{sx:{minWidth:720},children:[e.jsx(Oe,{headLabel:et}),e.jsx(Ie,{children:t.map(r=>e.jsx(U,{row:r,onDelete:()=>o(r.id),onDecrease:()=>i(r.id),onIncrease:()=>c(r.id)},r.id))})]})})})}V.propTypes={onDelete:a.func,products:a.array,onDecreaseQuantity:a.func,onIncreaseQuantity:a.func};function tt(){const t=D(),o=!t.items.length;return e.jsxs(v,{container:!0,spacing:3,children:[e.jsxs(v,{xs:12,md:8,children:[e.jsxs(k,{sx:{mb:3},children:[e.jsx(_,{title:e.jsxs(x,{variant:"h6",children:["Cart",e.jsxs(x,{component:"span",sx:{color:"text.secondary"},children:[" (",t.totalItems," item)"]})]}),sx:{mb:3}}),o?e.jsx(ke,{title:"Cart is Empty!",description:"Look like you have no items in your shopping cart.",imgUrl:"/assets/icons/empty/ic_cart.svg",sx:{pt:5,pb:10}}):e.jsx(V,{products:t==null?void 0:t.items,onDelete:t==null?void 0:t.onDeleteCart,onIncreaseQuantity:t==null?void 0:t.onIncreaseQuantity,onDecreaseQuantity:t==null?void 0:t.onDecreaseQuantity})]}),e.jsx(C,{component:_e,href:"/find-product",color:"inherit",startIcon:e.jsx(y,{icon:"eva:arrow-ios-back-fill"}),children:"Continue Shopping"})]}),e.jsxs(v,{xs:12,md:4,children:[e.jsx(A,{total:t.total,discount:t.discount,subTotal:t.subTotal,onApplyDiscount:t.onApplyDiscount,checked:t.checked,handleChange:t.handleCheckChange,shippingFee:t==null?void 0:t.shipping}),e.jsx(C,{fullWidth:!0,size:"large",type:"submit",variant:"contained",disabled:o,onClick:t.onNextStep,children:"Check Out"})]})]})}function K({billing:t,onBackStep:o}){return console.log(t),e.jsxs(k,{sx:{mb:3},children:[e.jsx(_,{title:"Address",action:e.jsx(C,{size:"small",startIcon:e.jsx(y,{icon:"solar:pen-bold"}),onClick:o,children:"Edit"})}),e.jsxs(p,{spacing:1,sx:{p:3},children:[e.jsxs(f,{sx:{typography:"subtitle2"},children:[`${t==null?void 0:t.order_reciver_name} `,e.jsxs(f,{component:"span",sx:{color:"text.secondary",typography:"body2"},children:["(",(t==null?void 0:t.type)==="home_delivery"?"Home":"Office",")"]})]}),e.jsx(f,{sx:{color:"text.secondary",typography:"body2"},children:`${t==null?void 0:t.address_line_1}, ${t==null?void 0:t.city}, ${t==null?void 0:t.country}, ${t==null?void 0:t.pincode}`}),e.jsx(f,{sx:{color:"text.secondary",typography:"body2"},children:t==null?void 0:t.order_reciver_mobile_number})]})]})}K.propTypes={billing:a.object,onBackStep:a.func};function Y({options:t,cardOptions:o,...c}){const{control:i}=De(),r=N();return e.jsxs(e.Fragment,{children:[e.jsxs(k,{...c,children:[e.jsx(_,{title:"Payment"}),e.jsx(Ae,{name:"payment",control:i,render:({field:s,fieldState:{error:l}})=>e.jsxs(p,{sx:{px:3,pb:3},children:[t.map(u=>e.jsx(Z,{option:u,onOpen:r.onTrue,cardOptions:o,selected:s.value===u.value,isCredit:u.value==="credit"&&s.value==="credit",onClick:()=>{s.onChange(u.value)}},u.label)),!!l&&e.jsx(Pe,{error:!0,sx:{pt:1,px:2},children:l.message})]})})]}),e.jsx(Ge,{open:r.value,onClose:r.onFalse})]})}Y.propTypes={cardOptions:a.array,options:a.array};function Z({option:t,cardOptions:o,selected:c,isCredit:i,onOpen:r,...s}){const{value:l,label:u,description:d}=t;return e.jsxs(q,{variant:"outlined",sx:{p:2.5,mt:2.5,cursor:"pointer",...c&&{boxShadow:n=>`0 0 0 2px ${n.palette.text.primary}`}},...s,children:[e.jsx(Ee,{primary:e.jsxs(p,{direction:"row",alignItems:"center",children:[e.jsx(f,{component:"span",sx:{flexGrow:1},children:u}),e.jsxs(p,{spacing:1,direction:"row",alignItems:"center",children:[l==="credit"&&e.jsxs(e.Fragment,{children:[e.jsx(y,{icon:"logos:mastercard",width:24}),",",e.jsx(y,{icon:"logos:visa",width:24})]}),l==="paypal"&&e.jsx(y,{icon:"logos:paypal",width:24}),l==="online"&&e.jsx(y,{icon:"solar:wad-of-money-bold",width:32})]})]}),secondary:d,primaryTypographyProps:{typography:"subtitle1",mb:.5},secondaryTypographyProps:{typography:"body2"}}),i&&e.jsxs(p,{spacing:2.5,alignItems:"flex-end",sx:{pt:2.5},children:[e.jsx(Me,{select:!0,fullWidth:!0,label:"Cards",SelectProps:{native:!0},children:o.map(n=>e.jsx("option",{value:n.value,children:n.label},n.value))}),e.jsx(C,{size:"small",color:"primary",startIcon:e.jsx(y,{icon:"mingcute:add-line"}),onClick:r,children:"Add New Card"})]})]},l)}Z.propTypes={cardOptions:a.array,isCredit:a.bool,onOpen:a.func,option:a.object,selected:a.bool};const st=[{value:"online",label:"Online",description:"Pay with your upi."}],rt=[{value:"ViSa1",label:"**** **** **** 1212 - Jimmy Holland"},{value:"ViSa2",label:"**** **** **** 2424 - Shawn Stokes"},{value:"MasterCard",label:"**** **** **** 4545 - Cole Armstrong"}];function nt(){const t=D(),o=W().shape({payment:g().required("Payment is required")}),c={delivery:t.shipping,payment:""},i=$({resolver:z(o),defaultValues:c}),{handleSubmit:r,formState:{isSubmitting:s}}=i,l=r(async()=>{var u,d,n,h,m;try{const b={products:(u=t==null?void 0:t.items)==null?void 0:u.map(M=>({productId:M.id,quantity:M.quantity})),addressId:t==null?void 0:t.billing.id,transactionID:new Date().toISOString(),useWalletBalance:t.checked},{data:j}=await I.post("/api/member/ecommerce/order/create",b),P={key:Fe,amount:(d=j==null?void 0:j.order)==null?void 0:d.amount,currency:"INR",name:"Return2Success",description:"Test Transaction",image:"https://example.com/your_logo",order_id:(n=j==null?void 0:j.order)==null?void 0:n.id,callback_url:`${Be}/api/member/ecommerce/order/verifyPayment?secretKey=${j==null?void 0:j.secretKey}`,prefill:{name:(h=t==null?void 0:t.billing)==null?void 0:h.order_reciver_name,email:"",contact:(m=t==null?void 0:t.billing)==null?void 0:m.order_reciver_mobile_number},notes:{address:"Razorpay Corporate Office"},theme:{color:"#3399cc"}};new window.Razorpay(P).open(),t==null||t.onReset()}catch(b){console.error(b)}});return e.jsx(L,{methods:i,onSubmit:l,children:e.jsxs(v,{container:!0,spacing:3,children:[e.jsxs(v,{xs:12,md:8,children:[e.jsx(Y,{cardOptions:rt,options:st,sx:{my:3}}),e.jsx(C,{size:"small",color:"inherit",onClick:t.onBackStep,startIcon:e.jsx(y,{icon:"eva:arrow-ios-back-fill"}),children:"Back"})]}),e.jsxs(v,{xs:12,md:4,children:[e.jsx(K,{billing:t.billing,onBackStep:t.onBackStep}),e.jsx(A,{total:t.total,subTotal:t.subTotal,discount:t.discount,shipping:t.shipping,onEdit:()=>t.onGotoStep(0),checked:t.checked,handleChange:t.handleCheckChange,shippingFee:t==null?void 0:t.shipping}),e.jsx(H,{fullWidth:!0,size:"large",type:"submit",variant:"contained",loading:s,children:"Complete Order"})]})]})})}const ot=qe(Ye)(({theme:t})=>({top:10,left:"calc(-50% + 20px)",right:"calc(50% + 20px)",[`& .${O.line}`]:{borderTopWidth:2,borderColor:t.palette.divider},[`&.${O.active}, &.${O.completed}`]:{[`& .${O.line}`]:{borderColor:t.palette.primary.main}}}));function J({steps:t,activeStep:o,sx:c,...i}){return e.jsx(Qe,{alternativeLabel:!0,activeStep:o,connector:e.jsx(ot,{}),sx:{mb:{xs:3,md:5},...c},...i,children:t.map(r=>e.jsx(Ue,{children:e.jsx(Ve,{StepIconComponent:X,sx:{[`& .${Ke.label}`]:{fontWeight:"fontWeightSemiBold"}},children:r})},r))})}J.propTypes={activeStep:a.number,steps:a.arrayOf(a.string),sx:a.object};function X({active:t,completed:o}){return e.jsx(p,{alignItems:"center",justifyContent:"center",sx:{width:24,height:24,color:"text.disabled",...t&&{color:"primary.main"}},children:o?e.jsx(y,{icon:"eva:checkmark-fill",sx:{color:"primary.main"}}):e.jsx(f,{sx:{width:8,height:8,borderRadius:"50%",backgroundColor:"currentColor"}})})}X.propTypes={active:a.bool,completed:a.bool};function at(){const t=We(),o=D();return e.jsxs($e,{maxWidth:t.themeStretch?!1:"lg",sx:{mb:10},children:[e.jsx(x,{variant:"h4",sx:{my:{xs:3,md:5}},children:"Checkout"}),e.jsx(v,{container:!0,justifyContent:o.completed?"center":"flex-start",children:e.jsx(v,{xs:12,md:8,children:e.jsx(J,{activeStep:o.activeStep,steps:Le})})}),o.completed?e.jsx(He,{open:o.completed,onReset:o.onReset,onDownloadPDF:()=>{}}):e.jsxs(e.Fragment,{children:[o.activeStep===0&&e.jsx(tt,{}),o.activeStep===1&&e.jsx(Xe,{}),o.activeStep===2&&e.jsx(nt,{})]})]})}function ht(){return e.jsxs(e.Fragment,{children:[e.jsx(ze,{children:e.jsx("title",{children:" Checkout"})}),e.jsx(at,{})]})}export{ht as default};

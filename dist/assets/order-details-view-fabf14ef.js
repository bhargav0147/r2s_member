import{l as o,j as e,aP as xe,k as Q,aQ as B,as as u,aR as X,aS as M,aT as A,aB as ue,r as d,u as he,aA as ee,a as te,p as w,aE as pe,aD as ae,aF as ye,ar as G,aU as je,au as ne,aV as be,aW as fe,aX as se,aY as ge,aZ as me,a_ as Se,a$ as ve,aK as De,ad as R,ae as Ce,at as O,S as c,T as N,b0 as oe,g as re,h as $,L as Te,b1 as z,b2 as P,aI as F,aL as Ie,b3 as ke,b4 as Ee,b5 as H,b6 as Pe,b7 as Re,R as _e,b8 as Le,b9 as Oe,ba as $e,bb as Ne,bc as Fe,aG as K}from"./index-6b9b4714.js";function le({row:t,onViewRow:l,isOrder:x,isMyOrder:a,isSupport:h}){const{status:f,orderStatus:b}=t;let p;x&&(p=`/order-history/${t==null?void 0:t.id}`),a&&(p=`/my-order/${t==null?void 0:t.id}`);const m=e.jsxs(xe,{hover:!0,to:p||"#",as:Q,sx:{textDecoration:"none"},children:[e.jsx(B,{children:e.jsx(u,{onClick:l,sx:{cursor:"pointer"},children:h?t==null?void 0:t.title:`â‚¹ ${t==null?void 0:t.amount}`})}),e.jsx(B,{children:e.jsx(X,{primary:M(new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.orderDate)||""),"dd MMM yyyy"),secondary:M(new Date((t==null?void 0:t.created_at)||(t==null?void 0:t.orderDate)||""),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}})}),e.jsx(B,{children:x||a?t==null?void 0:t.orderId:h?t==null?void 0:t.description:t!=null&&t.paid_at?e.jsx(X,{primary:M(new Date(t==null?void 0:t.paid_at),"dd MMM yyyy"),secondary:M(new Date(t==null?void 0:t.paid_at),"p"),primaryTypographyProps:{typography:"body2",noWrap:!0},secondaryTypographyProps:{mt:.5,component:"span",typography:"caption"}}):"-----"}),e.jsx(B,{children:e.jsx(A,{variant:"soft",color:(b==="approve"||f==="approved"||(t==null?void 0:t.supportStatus)==="APPROVED")&&"success"||(f==="pending"||b==="PENDING"||(t==null?void 0:t.supportStatus)==="PENDING")&&"warning"||f==="rejected"&&"error"||"default",children:t.status||b||(t==null?void 0:t.supportStatus)})})]});return e.jsx(e.Fragment,{children:m})}le.propTypes={onViewRow:o.func,row:o.object};const Ve=[{value:"all",label:"All"},{value:"PENDING",label:"Pending"},{value:"DELIVERED",label:"Delivered"},{value:"CANCELLED",label:"Cancelled"}],We={name:"",status:"all"};function Be({isOrder:t,isMyOrder:l}){var Z,J;const x=[{id:"amount",label:"Amount",width:116},{id:"requestDate",label:"Request Date",width:140},{id:t||l?"orderId":"releaseDate",label:t||l?"Order ID":"Release Date",width:250},{id:"status",label:"Status",width:110}],a=ue({}),[h,f]=d.useState([]),{user:b}=he(),p=async()=>{var r;try{const{data:i}=await R.get("/api/member/ecommerce/order/my");f((r=i==null?void 0:i.data)==null?void 0:r.orders)}catch(i){console.log(i)}},m=ee(),D=te(),[T,n]=d.useState(We),S=d.useCallback((r,i)=>{a.onResetPage(),n(j=>({...j,[r]:i}))},[a]),C=d.useCallback(r=>{console.log(r),D.push(w.dashboard.order.details(r))},[D]),g=d.useCallback((r,i)=>{S("status",i)},[S]),[y,v]=d.useState([]),[Y,U]=d.useState(0),q=async()=>{var r,i;try{const{data:j}=await R.get(Ce.payout.history);U((r=j==null?void 0:j.data)==null?void 0:r.totalPages),v((i=j==null?void 0:j.data)==null?void 0:i.data),console.log(y)}catch(j){console.log(j)}};d.useEffect(()=>{q()},[]);const[s,E]=d.useState("all"),[_,V]=d.useState([]),W=async()=>{var r;try{const{data:i}=await R.get("/api/member/ecommerce/order");V((r=i==null?void 0:i.data)==null?void 0:r.orders)}catch(i){console.log(i)}};d.useEffect(()=>{t&&p(),l&&W()},[t,l]);const L=r=>{if(r==="all")return t?h:l?_:y;let i;return t?i=h.filter(j=>j.orderStatus===r):l?i=_.filter(j=>j.orderStatus===r):i=y.filter(j=>j.status===r),i};let I,k;return t?(I="Order",k="Order"):l?(I="My Order",k="My Order"):(I="Withdrawal",k="Withdrawal"),e.jsxs(e.Fragment,{children:[e.jsx(pe,{}),e.jsxs(ae,{maxWidth:m.themeStretch?!1:"lg",children:[e.jsx(ye,{heading:I,links:[{name:"Dashboard",href:w.findBusiness},{name:k}],sx:{mb:{xs:3,md:5}}}),b!=null&&b.is_premium?e.jsxs(G,{children:[e.jsx(je,{value:T.status,onChange:g,sx:{px:2.5,boxShadow:r=>`inset 0 -2px 0 0 ${ne(r.palette.grey[500],.08)}`},children:Ve.map(r=>e.jsx(be,{onClick:()=>E(r.value),iconPosition:"end",value:r.value,label:r.label},r.value))}),e.jsx(fe,{sx:{position:"relative",overflow:"unset"},children:e.jsx(se,{children:e.jsxs(ge,{size:a.dense?"small":"medium",sx:{minWidth:960},children:[e.jsx(me,{headLabel:x}),e.jsxs(Se,{children:[(Z=L(s))==null?void 0:Z.map(r=>e.jsx(le,{isOrder:t,isMyOrder:l,row:r,onViewRow:()=>C(r.id)},r.id)),e.jsx(ve,{notFound:!((J=L(s))!=null&&J.length)})]})]})})})]}):e.jsx(De,{})]})]})}Be.propTypes={isOrder:o.bool,isMyOrder:o.bool};function ce({customer:t,delivery:l,payment:x,shippingAddress:a,isOrder:h,isMyOrder:f}){const b=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:e.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(N,{variant:"h6",component:"div",children:"Customer Info"}),f&&e.jsxs(N,{variant:"h6",component:"div",sx:{fontWeight:700,ml:2},children:["OTP - ",x==null?void 0:x.deliveryOtp]})]})}),e.jsxs(c,{direction:"row",sx:{p:3},children:[e.jsx(oe,{alt:t==null?void 0:t.full_name,src:t==null?void 0:t.avatarUrl,sx:{width:48,height:48,mr:2}}),e.jsxs(c,{spacing:.5,alignItems:"flex-start",sx:{typography:"body2"},children:[e.jsx(N,{variant:"subtitle2",children:t==null?void 0:t.full_name}),e.jsx(u,{sx:{color:"text.secondary"},children:t==null?void 0:t.Contact_no})]})]})]});e.Fragment,O,re,$,c,c,u,l==null||l.shipBy,c,u,l==null||l.speedy,c,u,Te,l==null||l.trackingNumber;const p=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Shipping"}),e.jsxs(c,{spacing:1.5,sx:{p:3,typography:"body2"},children:[e.jsxs(c,{direction:"row",children:[e.jsx(u,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Address"}),`${a!=null&&a.address_line_1?a==null?void 0:a.address_line_1:""}  ${a!=null&&a.address_line_2?a==null?void 0:a.address_line_2:""}  ${a!=null&&a.city?a==null?void 0:a.city:""}  ${a==null?void 0:a.state}  ${a==null?void 0:a.country}  ${a==null?void 0:a.pincode}`]}),e.jsxs(c,{direction:"row",children:[e.jsx(u,{component:"span",sx:{color:"text.secondary",width:120,flexShrink:0},children:"Phone number"}),t==null?void 0:t.Contact_no]})]})]}),m=e.jsxs(e.Fragment,{children:[e.jsx(O,{title:"Payment"}),e.jsxs(c,{direction:"row",alignItems:"center",sx:{p:3,typography:"body2"},children:[e.jsx(u,{component:"span",sx:{color:"text.secondary",flexGrow:1},children:"Transaction Id"}),x==null?void 0:x.orderId]})]});return e.jsxs(G,{children:[b,e.jsx(z,{sx:{borderStyle:"dashed"}}),e.jsx(z,{sx:{borderStyle:"dashed"}}),p,e.jsx(z,{sx:{borderStyle:"dashed"}}),m]})}ce.propTypes={customer:o.object,delivery:o.object,payment:o.object,shippingAddress:o.object};function ie({items:t,taxes:l,shipping:x,discount:a,subTotal:h,totalAmount:f,isMyOrder:b,orderStatus:p}){const[m,D]=d.useState(!1),T=()=>{D(!1)},[n,S]=d.useState(0),[C,g]=d.useState(""),[y,v]=d.useState(""),Y=d.useRef(null),U=async()=>{try{const{data:s}=await R.post(`/api/member/feedback/business/add/${y}`,{comment:C,rating:n,type:"product"});s.success&&(S(0),g(""),T(),H("Review submitted successfully",{variant:"success"}))}catch(s){H(typeof s=="string"?s:s.message,{variant:"error"})}};console.log(x,"this is a shipping fee");const q=e.jsxs(c,{spacing:2,alignItems:"flex-end",sx:{my:3,textAlign:"right",typography:"body2"},children:[e.jsxs(c,{direction:"row",children:[e.jsx(u,{sx:{color:"text.secondary"},children:"Subtotal"}),e.jsx(u,{sx:{width:160,typography:"subtitle2"},children:P(h)||"-"})]}),e.jsxs(c,{direction:"row",children:[e.jsx(u,{sx:{color:"text.secondary"},children:"Shipping"}),e.jsx(u,{sx:{width:160,...x&&{color:"success.main"}},children:x?`+ ${P(x)}`:"0"})]}),e.jsxs(c,{direction:"row",children:[e.jsx(u,{sx:{color:"text.secondary"},children:"Discount"}),e.jsx(u,{sx:{width:160,...a&&{color:"error.main"}},children:a?`- ${P(a)}`:"-"})]}),e.jsxs(c,{direction:"row",children:[e.jsx(u,{sx:{color:"text.secondary"},children:"Taxes"}),e.jsx(u,{sx:{width:160},children:l?P(l):"-"})]}),e.jsxs(c,{direction:"row",sx:{typography:"subtitle1"},children:[e.jsx(u,{children:"Total"}),e.jsx(u,{sx:{width:160},children:P(f)||"-"})]})]});return e.jsxs(G,{children:[e.jsx(O,{title:"Details"}),e.jsxs(c,{sx:{px:3},children:[e.jsx(se,{children:t==null?void 0:t.map(s=>{var E,_,V,W,L;return e.jsx(c,{direction:"column",children:e.jsxs(c,{direction:"row",alignItems:"center",sx:{py:3,minWidth:640,borderBottom:I=>`dashed 2px ${I.palette.background.neutral}`,textDecoration:"none",color:"inherit"},children:[e.jsx(oe,{src:(_=(E=s==null?void 0:s.product)==null?void 0:E.pictures[0])==null?void 0:_.image_url,variant:"rounded",sx:{width:48,height:48,mr:2},as:Q,to:`/product/${(V=s==null?void 0:s.product)==null?void 0:V.id}`}),e.jsx(X,{as:Q,sx:{textDecoration:"none",color:"inherit"},to:`/product/${(W=s==null?void 0:s.product)==null?void 0:W.id}`,primary:(L=s==null?void 0:s.product)==null?void 0:L.title,primaryTypographyProps:{typography:"body2"},secondaryTypographyProps:{component:"span",color:"text.disabled",mt:.5}}),e.jsx(u,{sx:{width:110,textAlign:"right",typography:"subtitle2"},children:P(s.product.price)}),e.jsxs(u,{sx:{typography:"body2"},children:["x",s.quantity]}),b&&p==="DELIVERED"&&e.jsx(F,{variant:"outlined",onClick:I=>{var k;I.stopPropagation(),v((k=s==null?void 0:s.product)==null?void 0:k.id),D(!0)},sx:{marginLeft:"50px",backgroundColor:"green",color:"white",fontWeight:"normal"},children:"Add Review"})]},s.id)})})}),q]}),e.jsx(Ie,{open:m,onClose:T,children:e.jsx(u,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:600,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:"10px"},children:e.jsxs(G,{sx:{p:3},children:[e.jsx(ke,{multiline:!0,fullWidth:!0,rows:4,value:C,onChange:s=>g(s.target.value),placeholder:"Share your valuable feedback...",sx:{p:2,mb:3,borderRadius:1,border:s=>`solid 1px ${ne(s.palette.grey[500],.2)}`}}),e.jsxs(c,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(Ee,{name:"read-only",value:n,onChange:(s,E)=>{S(E)}}),e.jsx(F,{variant:"contained",onClick:U,children:"Submit"})]}),e.jsx("input",{ref:Y,type:"file",style:{display:"none"}})]})})})]})}ie.propTypes={discount:o.number,items:o.array,shipping:o.number,subTotal:o.number,taxes:o.number,totalAmount:o.number,isMyOrder:o.bool,orderStatus:o.string};function de({status:t,backLink:l,createdAt:x,orderNumber:a,statusOptions:h,onChangeStatus:f,isMyOrder:b,isOrder:p,setDeliveryOtp:m,updateStatus:D,deliveryOtp:T,orderId:n}){const S=Pe(),C=Re();return e.jsxs(e.Fragment,{children:[e.jsxs(c,{spacing:3,direction:{xs:"column",md:"row"},sx:{mb:{xs:3,md:5}},justifyContent:"space-between",children:[e.jsxs(c,{spacing:1,direction:"row",alignItems:"flex-start",children:[e.jsx(re,{component:_e,href:l,children:e.jsx($,{icon:"eva:arrow-ios-back-fill"})}),e.jsxs(c,{spacing:.5,children:[e.jsxs(c,{spacing:1,direction:"row",alignItems:"center",children:[e.jsxs(N,{variant:"h4",children:[" Order ",a," "]}),e.jsx(A,{variant:"soft",color:t==="completed"&&"success"||t==="pending"&&"warning"||t==="cancelled"&&"error"||"default",children:t})]}),e.jsx(N,{variant:"body2",sx:{color:"text.disabled"},children:Le(x)})]})]}),e.jsxs(c,{direction:"column",sx:{gap:2},children:[e.jsxs(c,{flexGrow:1,spacing:1.5,direction:"row",alignItems:"center",justifyContent:"flex-end",children:[e.jsx(F,{onClick:()=>{C(`/order-inovoice/${n}`)},color:"inherit",variant:"outlined",startIcon:e.jsx($,{icon:"solar:printer-minimalistic-bold"}),children:"Print"}),p&&e.jsx(F,{color:"inherit",variant:"outlined",endIcon:e.jsx($,{icon:"eva:arrow-ios-downward-fill"}),onClick:S.onOpen,sx:{textTransform:"capitalize"},children:t}),p&&e.jsx(F,{color:"inherit",variant:"contained",startIcon:e.jsx($,{icon:"ic:baseline-save"}),onClick:D,children:"Save"})]}),t==="DELIVERED"&&e.jsx(Oe,{placeholder:"Enter Delivery Otp",value:T,onChange:g=>{m(g.target.value)}})]})]}),e.jsx($e,{open:S.open,onClose:S.onClose,arrow:"top-right",sx:{width:140},children:h.map(g=>e.jsx(Ne,{selected:g.value===t,onClick:()=>{S.onClose(),f(g.value)},children:g.label},g.value))})]})}de.propTypes={backLink:o.string,createdAt:o.instanceOf(Date),onChangeStatus:o.func,orderNumber:o.string,status:o.string,statusOptions:o.array,isMyOrder:o.bool,isOrder:o.bool,setDeliveryOtp:o.func,updateStatus:o.func,deliveryOtp:o.string,orderId:o.string};const Me=[{value:"PENDING",label:"Pending"},{value:"DELIVERED",label:"Delivered"},{value:"CANCELLED",label:"Cancelled"}];function Ge({id:t,isOrder:l,isMyOrder:x}){const a=ee(),h=Fe.filter(y=>y.id===t)[0],[f,b]=d.useState("PENDING"),[p,m]=d.useState(),D=te(),T=d.useCallback(y=>{b(y),y!=="DELIVERED"&&m()},[]),[n,S]=d.useState(),C=d.useCallback(async()=>{var y;try{const{data:v}=await R.get(`/api/member/ecommerce/order/single/${t}`);S(v==null?void 0:v.data),b((y=v==null?void 0:v.data)==null?void 0:y.orderStatus)}catch(v){console.log(v)}},[t]),g=async()=>{try{(await R.put(`/api/member/ecommerce/order/status/${t}`,{status:f,...p&&{deliveryOtp:p}})).status===200&&(H("Status Updated Successfully!!",{variant:"success"}),D.back())}catch(y){H(y.message,{variant:"error"}),D.back()}};return d.useEffect(()=>{C()},[C]),d.useEffect(()=>{console.log(p,"this is delivery otp")},[p]),e.jsxs(ae,{maxWidth:a.themeStretch?!1:"lg",children:[e.jsx(de,{backLink:`${l?"/order-history":"/my-order"}`,orderNumber:n==null?void 0:n.orderId,createdAt:n==null?void 0:n.orderDate,status:f,onChangeStatus:T,statusOptions:Me,isMyOrder:x,isOrder:l,setDeliveryOtp:m,updateStatus:g,deliveryOtp:p,orderId:t}),e.jsxs(K,{container:!0,spacing:3,children:[e.jsx(K,{xs:12,md:8,children:e.jsx(c,{spacing:3,direction:{xs:"column-reverse",md:"column"},children:e.jsx(ie,{items:n==null?void 0:n.products,taxes:h==null?void 0:h.taxes,discount:h==null?void 0:h.discount,subTotal:n==null?void 0:n.subAmount,totalAmount:n==null?void 0:n.amount,isMyOrder:x,orderStatus:n==null?void 0:n.orderStatus,shipping:n==null?void 0:n.shippingFee})})}),e.jsx(K,{xs:12,md:4,children:e.jsx(ce,{customer:n==null?void 0:n.buyer,delivery:h==null?void 0:h.delivery,payment:n,shippingAddress:n==null?void 0:n.address,isOrder:l,isMyOrder:x})})]})]})}Ge.propTypes={id:o.string,isOrder:o.bool,isMyOrder:o.bool};export{Be as O,Ge as a};
